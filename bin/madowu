#! /usr/bin/env ruby
# coding: utf-8

require "optparse"
require "pp"
require "fileutils"
require "madowu"

MARKDOWN = "markdown"
ENCODING = "UTF-8"
HTML2PDF = "wkhtmltopdf"
HTML2PDF_OPTIONS = "-B 1cm -L 1.5cm -R 1.5cm -T 1.5cm -s A4 --encoding #{ENCODING} "

### option analysis
OPTIONS = {}
op = OptionParser.new
op.banner = [
  "Usage: #{File.basename("#{__FILE__}")}",
].join("\n")
op.on("-c css_file", "--css=file", "Indicate css file"){|v| OPTIONS[:css] = v}
op.on("-o"    , "--outline"    , "Embed outline"){    OPTIONS[:outline] = true}
op.on("-m"    , "--map-sidebar", "Embed map in sidebar"){ OPTIONS[:map] = true}
op.parse!(ARGV)

#pp OPTIONS

md_file = ARGV[0]
html_file = md_file.sub(/\.md/, ".html")
hg = Madowu::HtmlGenerator.new(md_file)
File.open(html_file, "w") { |io| io.puts hg.generate(OPTIONS) }
